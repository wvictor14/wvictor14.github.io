<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>planet â€¢ planet</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="planet">
<meta property="og:description" content="planet">
<meta property="og:image" content="/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">planet</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/planet.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="http://github.com/wvictor14/planet/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="planet_files/header-attrs-2.8/header-attrs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>planet</h1>
            
      
      <small class="dont-index">Source: <a href="http://github.com/wvictor14/planet/blob/master/vignettes/planet.Rmd"><code>vignettes/planet.Rmd</code></a></small>
      <div class="hidden name"><code>planet.Rmd</code></div>

    </div>

    
    
<div id="installation" class="section level2">
<h2 class="hasAnchor">
<a href="#installation" class="anchor"></a>Installation</h2>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw">if</span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html">requireNamespace</a></span><span class="op">(</span><span class="st">"BiocManager"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span>
    <span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span><span class="op">(</span><span class="st">"BiocManager"</span><span class="op">)</span>
<span class="fu">BiocManager</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/BiocManager/man/install.html">install</a></span><span class="op">(</span><span class="st">"planet"</span><span class="op">)</span></code></pre></div>
</div>
<div id="cell-composition" class="section level2">
<h2 class="hasAnchor">
<a href="#cell-composition" class="anchor"></a>Cell composition</h2>
<p>To infer cell composition on placental villi DNAm samples, we can need to use placental reference cpgs <a href="https://bmcgenomics.biomedcentral.com/articles/10.1186/s12864-020-07186-6">(Yuan 2021)</a>. These are provided in this package as <code>plCellCpGsThird</code> and <code>plCellCpGsFirst</code> for third trimester (term) and first trimester samples, respectively.</p>
<p>In this example we are using term villi DNAm data, so we first load the reference cpgs <code>plCellCpGsThird</code>. This is a data frame of 600 cpgs, with mean methylation levels for each cell type.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># cell deconvolution packages</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/hansenlab/minfi">minfi</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/sjczheng/EpiDISH">EpiDISH</a></span><span class="op">)</span>

<span class="co"># data wrangling and plotting</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org">dplyr</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org">tidyr</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://victor.rbind.io/planet">planet</a></span><span class="op">)</span>

<span class="co"># load example data</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">"plBetas"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">"plCellCpGsThird"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">plCellCpGsThird</span><span class="op">)</span></code></pre></div>
<pre><code>##            Trophoblasts   Stromal  Hofbauer Endothelial      nRBC
## cg10590657    0.1014098 0.9345796 0.8655285   0.8963641 0.8448382
## cg14923398    0.1282030 0.8902107 0.9036769   0.9383641 0.9508709
## cg05348366    0.1305697 0.9519820 0.8803082   0.9065136 0.9278057
## cg17907628    0.1215249 0.9278777 0.8727841   0.8914412 0.9143601
## cg26799656    0.1259953 0.9482014 0.8803863   0.8791004 0.9010419
## cg11862144    0.1561991 0.9430855 0.9114967   0.9341671 0.9647331
##            Syncytiotrophoblast
## cg10590657          0.05460441
## cg14923398          0.05383193
## cg05348366          0.06546727
## cg17907628          0.05325227
## cg26799656          0.06823985
## cg11862144          0.06044207</code></pre>
<p>After our reference cpg data is loaded, we can estimate cell composition by applying either the Constrained Projection approach implemented by the R packages minfi or EpiDISH, or a non-constrained approach by EpiDish. I demonstrate how to do both.</p>
<div id="minfi" class="section level4">
<h4 class="hasAnchor">
<a href="#minfi" class="anchor"></a>Minfi</h4>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">houseman_estimates</span> <span class="op">&lt;-</span> <span class="fu">minfi</span><span class="fu">:::</span><span class="fu">projectCellType</span><span class="op">(</span>
    <span class="va">plBetas</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">plCellCpGsThird</span><span class="op">)</span>, <span class="op">]</span>,
    <span class="va">plCellCpGsThird</span>,
    lessThanOne <span class="op">=</span> <span class="cn">FALSE</span>
<span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">houseman_estimates</span><span class="op">)</span></code></pre></div>
<pre><code>##            Trophoblasts    Stromal      Hofbauer Endothelial       nRBC
## GSM1944936    0.1091279 0.04891919  0.000000e+00  0.08983998 0.05294062
## GSM1944939    0.2299918 0.00000000 -1.806592e-19  0.07888007 0.03374149
## GSM1944942    0.1934287 0.03483540  0.000000e+00  0.09260353 0.02929310
## GSM1944944    0.2239896 0.06249135  1.608645e-03  0.11040693 0.04447951
## GSM1944946    0.1894152 0.07935955  0.000000e+00  0.10587439 0.05407587
## GSM1944948    0.2045124 0.07657717  0.000000e+00  0.09871149 0.02269798
##            Syncytiotrophoblast
## GSM1944936           0.6979477
## GSM1944939           0.6377822
## GSM1944942           0.6350506
## GSM1944944           0.5467642
## GSM1944946           0.6022329
## GSM1944948           0.6085825</code></pre>
</div>
<div id="epidish" class="section level4">
<h4 class="hasAnchor">
<a href="#epidish" class="anchor"></a>EpiDISH</h4>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># robust partial correlations</span>
<span class="va">epidish_RPC</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/EpiDISH/man/epidish.html">epidish</a></span><span class="op">(</span>
    beta.m <span class="op">=</span> <span class="va">plBetas</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">plCellCpGsThird</span><span class="op">)</span>, <span class="op">]</span>,
    ref.m <span class="op">=</span> <span class="va">plCellCpGsThird</span>,
    method <span class="op">=</span> <span class="st">"RPC"</span>
<span class="op">)</span>

<span class="co"># CIBERSORT</span>
<span class="va">epidish_CBS</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/EpiDISH/man/epidish.html">epidish</a></span><span class="op">(</span>
    beta.m <span class="op">=</span> <span class="va">plBetas</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">plCellCpGsThird</span><span class="op">)</span>, <span class="op">]</span>,
    ref.m <span class="op">=</span> <span class="va">plCellCpGsThird</span>,
    method <span class="op">=</span> <span class="st">"CBS"</span>
<span class="op">)</span></code></pre></div>
<pre><code>## 1</code></pre>
<pre><code>## 2</code></pre>
<pre><code>## 3</code></pre>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># constrained projection (houseman 2012)</span>
<span class="va">epidish_CP</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/EpiDISH/man/epidish.html">epidish</a></span><span class="op">(</span>
    beta.m <span class="op">=</span> <span class="va">plBetas</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">plCellCpGsThird</span><span class="op">)</span>, <span class="op">]</span>,
    ref.m <span class="op">=</span> <span class="va">plCellCpGsThird</span>,
    method <span class="op">=</span> <span class="st">"CP"</span>
<span class="op">)</span></code></pre></div>
<pre><code>## 1</code></pre>
<pre><code>## 2</code></pre>
<pre><code>## 3</code></pre>
<pre><code>## 4</code></pre>
<pre><code>## 5</code></pre>
<pre><code>## 6</code></pre>
<pre><code>## 7</code></pre>
<pre><code>## 8</code></pre>
<pre><code>## 9</code></pre>
<pre><code>## 10</code></pre>
<pre><code>## 11</code></pre>
<pre><code>## 12</code></pre>
<pre><code>## 13</code></pre>
<pre><code>## 14</code></pre>
<pre><code>## 15</code></pre>
<pre><code>## 16</code></pre>
<pre><code>## 17</code></pre>
<pre><code>## 18</code></pre>
<pre><code>## 19</code></pre>
<pre><code>## 20</code></pre>
<pre><code>## 21</code></pre>
<pre><code>## 22</code></pre>
<pre><code>## 23</code></pre>
<pre><code>## 24</code></pre>
</div>
<div id="compare" class="section level4">
<h4 class="hasAnchor">
<a href="#compare" class="anchor"></a>Compare</h4>
<p>Below, I demonstrate how we can visually compare the different cell composition estimates.</p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">"plColors"</span><span class="op">)</span>

<span class="co"># bind estimate data frames and reshape for plotting</span>
<span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind.html">bind_rows</a></span><span class="op">(</span>
    <span class="va">houseman_estimates</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>algorithm <span class="op">=</span> <span class="st">"CP (Houseman)"</span><span class="op">)</span>,
    <span class="va">epidish_RPC</span><span class="op">$</span><span class="va">estF</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>algorithm <span class="op">=</span> <span class="st">"RPC"</span><span class="op">)</span>,
    <span class="va">epidish_CBS</span><span class="op">$</span><span class="va">estF</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>algorithm <span class="op">=</span> <span class="st">"CBS"</span><span class="op">)</span>,
    <span class="va">epidish_CP</span><span class="op">$</span><span class="va">estF</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>algorithm <span class="op">=</span> <span class="st">"CP (EpiDISH)"</span><span class="op">)</span>
<span class="op">)</span> <span class="op">%&gt;%</span>
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>sample <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">houseman_estimates</span><span class="op">)</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
    <span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html">as_tibble</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span>
    <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer</a></span><span class="op">(</span>
        cols <span class="op">=</span> <span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">algorithm</span>, <span class="va">sample</span><span class="op">)</span>,
        names_to <span class="op">=</span> <span class="st">"component"</span>,
        values_to <span class="op">=</span> <span class="st">"estimate"</span>
    <span class="op">)</span> <span class="op">%&gt;%</span>

    <span class="co"># relevel for plot</span>
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>component <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">component</span>,
        levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>
            <span class="st">"nRBC"</span>, <span class="st">"Endothelial"</span>, <span class="st">"Hofbauer"</span>,
            <span class="st">"Stromal"</span>, <span class="st">"Trophoblasts"</span>,
            <span class="st">"Syncytiotrophoblast"</span>
        <span class="op">)</span>
    <span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>

    <span class="co"># plot</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">sample</span>, y <span class="op">=</span> <span class="va">estimate</span>, fill <span class="op">=</span> <span class="va">component</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span>stat <span class="op">=</span> <span class="st">"identity"</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">algorithm</span>, ncol <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_fill_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="va">plColors</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span><span class="op">(</span>
        limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.1</span>, <span class="fl">1.1</span><span class="op">)</span>, breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.5</span>, <span class="fl">1</span><span class="op">)</span>,
        labels <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="va"><a href="https://scales.r-lib.org/reference/label_percent.html">percent</a></span>
    <span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>axis.text.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">90</span>, vjust <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_cartesian.html">coord_cartesian</a></span><span class="op">(</span>ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">""</span>, fill <span class="op">=</span> <span class="st">""</span><span class="op">)</span></code></pre></div>
<p><img src="planet_files/figure-html/unnamed-chunk-5-1.png"></p>
<p>Some notes:</p>
<ul>
<li>Normalize your data with <code><a href="https://rdrr.io/pkg/minfi/man/preprocessNoob.html">minfi::preprocessNoob</a></code> and BMIQ</li>
<li>Use all cell CpGs - if some are missing, estimates may vary</li>
<li>If your samples have been processed in a particular manner, (e.g.Â sampling from maternal side) expect cell composition to reflect that</li>
</ul>
</div>
</div>
<div id="gestational-age" class="section level2">
<h2 class="hasAnchor">
<a href="#gestational-age" class="anchor"></a>Gestational age</h2>
<div id="example-data" class="section level4">
<h4 class="hasAnchor">
<a href="#example-data" class="anchor"></a>Example Data</h4>
<p>For demonstration, I use 24 samples from a placental DNAm dataset from GEO, (<a href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE75196">GSE7519</a>), which contains samples collected in an Australian population. The DNA methylation data (in betas) can be accessed with <code><a href="https://rdrr.io/r/utils/data.html">data(plBetas)</a></code> and corresponding sample information from <code><a href="https://rdrr.io/r/utils/data.html">data(plPhenoData)</a></code>. Note that for demonstration purposes, the cpgs have been filtered to a random ~10,000 CpGs, plus the CpGs used in all of the functions from this package.</p>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># load example data</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">plBetas</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">plPhenoData</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/base/dim.html">dim</a></span><span class="op">(</span><span class="va">plBetas</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] 13918    24</code></pre>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#&gt; [1] 13918    24</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">plPhenoData</span><span class="op">)</span></code></pre></div>
<div class="kable-table">
<table class="table">
<thead><tr class="header">
<th align="left">sample_id</th>
<th align="left">sex</th>
<th align="left">disease</th>
<th align="right">gestation_wk</th>
<th align="right">ga_RPC</th>
<th align="right">ga_CPC</th>
<th align="right">ga_RRPC</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">GSM1944936</td>
<td align="left">Male</td>
<td align="left">preeclampsia</td>
<td align="right">36</td>
<td align="right">38.46528</td>
<td align="right">38.72867</td>
<td align="right">38.65396</td>
</tr>
<tr class="even">
<td align="left">GSM1944939</td>
<td align="left">Male</td>
<td align="left">preeclampsia</td>
<td align="right">32</td>
<td align="right">33.09680</td>
<td align="right">34.21252</td>
<td align="right">32.62763</td>
</tr>
<tr class="odd">
<td align="left">GSM1944942</td>
<td align="left">Female</td>
<td align="left">preeclampsia</td>
<td align="right">32</td>
<td align="right">34.32520</td>
<td align="right">35.09565</td>
<td align="right">33.32502</td>
</tr>
<tr class="even">
<td align="left">GSM1944944</td>
<td align="left">Male</td>
<td align="left">preeclampsia</td>
<td align="right">35</td>
<td align="right">35.50937</td>
<td align="right">36.71512</td>
<td align="right">35.51295</td>
</tr>
<tr class="odd">
<td align="left">GSM1944946</td>
<td align="left">Female</td>
<td align="left">preeclampsia</td>
<td align="right">38</td>
<td align="right">37.63910</td>
<td align="right">37.57931</td>
<td align="right">36.61721</td>
</tr>
<tr class="even">
<td align="left">GSM1944948</td>
<td align="left">Female</td>
<td align="left">preeclampsia</td>
<td align="right">36</td>
<td align="right">36.77051</td>
<td align="right">38.42632</td>
<td align="right">36.72150</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#&gt; # A tibble: 6 x 7</span>
<span class="co">#&gt;   sample_id  sex   disease   gestation_wk ga_RPC ga_CPC ga_RRPC</span>
<span class="co">#&gt;   &lt;fct&gt;      &lt;chr&gt; &lt;chr&gt;            &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;</span>
<span class="co">#&gt; 1 GSM1944936 Male  preeclam~           36   38.5   38.7    38.7</span>
<span class="co">#&gt; 2 GSM1944939 Male  preeclam~           32   33.1   34.2    32.6</span>
<span class="co">#&gt; 3 GSM1944942 Fema~ preeclam~           32   34.3   35.1    33.3</span>
<span class="co">#&gt; 4 GSM1944944 Male  preeclam~           35   35.5   36.7    35.5</span>
<span class="co">#&gt; 5 GSM1944946 Fema~ preeclam~           38   37.6   37.6    36.6</span>
<span class="co">#&gt; 6 GSM1944948 Fema~ preeclam~           36   36.8   38.4    36.7</span></code></pre></div>
<p>There are 3 gestational age clocks for placental DNA methylation data from <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC6628997/">(Lee 2019)</a>:</p>
<ol style="list-style-type: decimal">
<li>Robust Placental Clock (RPC)</li>
<li>Control Placental Clock (CPC)</li>
<li>Refined Robust Placental Clock (RRPC)</li>
</ol>
<p>To predict gestational, we load the example data:</p>
<ul>
<li>
<code>plBetas</code> - DNAm data for 24 placental samples</li>
<li>
<code>plPhenoData</code> - Matching sample information</li>
</ul>
</div>
<div id="predict-gestational-age" class="section level4">
<h4 class="hasAnchor">
<a href="#predict-gestational-age" class="anchor"></a>Predict Gestational Age</h4>
<p>To select the type of clock, we can specify the <code>type</code> argument in <code>predictAge</code>.</p>
<p>We will apply all three clocks on this data, and add the predicted age to the sample information data.frame, <code>plPhenoData</code>.</p>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">plPhenoData</span> <span class="op">&lt;-</span> <span class="va">plPhenoData</span> <span class="op">%&gt;%</span>
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>
        ga_RPC <span class="op">=</span> <span class="fu"><a href="../reference/predictAge.html">predictAge</a></span><span class="op">(</span><span class="va">plBetas</span>, type <span class="op">=</span> <span class="st">"RPC"</span><span class="op">)</span>,
        ga_CPC <span class="op">=</span> <span class="fu"><a href="../reference/predictAge.html">predictAge</a></span><span class="op">(</span><span class="va">plBetas</span>, type <span class="op">=</span> <span class="st">"CPC"</span><span class="op">)</span>,
        ga_RRPC <span class="op">=</span> <span class="fu"><a href="../reference/predictAge.html">predictAge</a></span><span class="op">(</span><span class="va">plBetas</span>, type <span class="op">=</span> <span class="st">"RRPC"</span><span class="op">)</span>
    <span class="op">)</span></code></pre></div>
<pre><code>## 558 of 558 predictors present.</code></pre>
<pre><code>## 546 of 546 predictors present.</code></pre>
<pre><code>## 395 of 395 predictors present.</code></pre>
<p>Note that the number of predictors (CpGs) that were used in our data are printed. Itâ€™s important to take note if a significant number of predictive CpGs are missing in your data, as this can affect the predicted gestational age accuracy.</p>
<p>Next, I plot the difference between predicted and reported gestational age, for each of the 3 gestational age predictors.</p>
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">plPhenoData</span> <span class="op">%&gt;%</span>
  
    <span class="co"># reshape, to plot</span>
    <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer</a></span><span class="op">(</span>
        cols <span class="op">=</span> <span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html">contains</a></span><span class="op">(</span><span class="st">"ga"</span><span class="op">)</span>,
        names_to <span class="op">=</span> <span class="st">"clock_type"</span>,
        names_prefix <span class="op">=</span> <span class="st">"ga_"</span>,
        values_to <span class="op">=</span> <span class="st">"ga"</span>
    <span class="op">)</span> <span class="op">%&gt;%</span>

    <span class="co"># plot code</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">gestation_wk</span>, y <span class="op">=</span> <span class="va">ga</span>, col <span class="op">=</span> <span class="va">disease</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"lm"</span>, se <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">clock_type</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"top"</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Reported GA (weeks)"</span>, y <span class="op">=</span> <span class="st">"Inferred GA (weeks)"</span>, col <span class="op">=</span> <span class="st">""</span><span class="op">)</span></code></pre></div>
<pre><code>## `geom_smooth()` using formula 'y ~ x'</code></pre>
<p><img src="planet_files/figure-html/unnamed-chunk-8-1.png"></p>
</div>
</div>
<div id="ethnicity" class="section level2">
<h2 class="hasAnchor">
<a href="#ethnicity" class="anchor"></a>Ethnicity</h2>
<p>Before predicting ethnicity You can ensure that you have all features using the <code>ethnicityCpGs</code> vector:</p>
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">ethnicityCpGs</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/all.html">all</a></span><span class="op">(</span><span class="va">ethnicityCpGs</span> <span class="op">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">plBetas</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode" id="cb48"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">results</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/predictEthnicity.html">predictEthnicity</a></span><span class="op">(</span><span class="va">plBetas</span><span class="op">)</span></code></pre></div>
<pre><code>## 1860 of 1860 predictors present.</code></pre>
<div class="sourceCode" id="cb50"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">results</span> <span class="op">%&gt;%</span>
    <span class="fu"><a href="https://rdrr.io/r/utils/head.html">tail</a></span><span class="op">(</span><span class="fl">8</span><span class="op">)</span></code></pre></div>
<div class="kable-table">
<table class="table">
<colgroup>
<col width="9%">
<col width="25%">
<col width="17%">
<col width="11%">
<col width="9%">
<col width="13%">
<col width="11%">
</colgroup>
<thead><tr class="header">
<th align="left">Sample_ID</th>
<th align="left">Predicted_ethnicity_nothresh</th>
<th align="left">Predicted_ethnicity</th>
<th align="right">Prob_African</th>
<th align="right">Prob_Asian</th>
<th align="right">Prob_Caucasian</th>
<th align="right">Highest_Prob</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">GSM1944959</td>
<td align="left">Asian</td>
<td align="left">Asian</td>
<td align="right">0.0123073</td>
<td align="right">0.9523544</td>
<td align="right">0.0353383</td>
<td align="right">0.9523544</td>
</tr>
<tr class="even">
<td align="left">GSM1944960</td>
<td align="left">Caucasian</td>
<td align="left">Caucasian</td>
<td align="right">0.0156961</td>
<td align="right">0.1595213</td>
<td align="right">0.8247827</td>
<td align="right">0.8247827</td>
</tr>
<tr class="odd">
<td align="left">GSM1944961</td>
<td align="left">Asian</td>
<td align="left">Asian</td>
<td align="right">0.0208421</td>
<td align="right">0.8954518</td>
<td align="right">0.0837061</td>
<td align="right">0.8954518</td>
</tr>
<tr class="even">
<td align="left">GSM1944962</td>
<td align="left">Caucasian</td>
<td align="left">Caucasian</td>
<td align="right">0.0009276</td>
<td align="right">0.0008801</td>
<td align="right">0.9981923</td>
<td align="right">0.9981923</td>
</tr>
<tr class="odd">
<td align="left">GSM1944963</td>
<td align="left">Caucasian</td>
<td align="left">Caucasian</td>
<td align="right">0.0022635</td>
<td align="right">0.0028007</td>
<td align="right">0.9949358</td>
<td align="right">0.9949358</td>
</tr>
<tr class="even">
<td align="left">GSM1944964</td>
<td align="left">Caucasian</td>
<td align="left">Caucasian</td>
<td align="right">0.0065973</td>
<td align="right">0.0112013</td>
<td align="right">0.9822014</td>
<td align="right">0.9822014</td>
</tr>
<tr class="odd">
<td align="left">GSM1944965</td>
<td align="left">Caucasian</td>
<td align="left">Caucasian</td>
<td align="right">0.0021578</td>
<td align="right">0.0024196</td>
<td align="right">0.9954226</td>
<td align="right">0.9954226</td>
</tr>
<tr class="even">
<td align="left">GSM1944966</td>
<td align="left">Caucasian</td>
<td align="left">Caucasian</td>
<td align="right">0.0011397</td>
<td align="right">0.0017651</td>
<td align="right">0.9970952</td>
<td align="right">0.9970952</td>
</tr>
</tbody>
</table>
</div>
<p><code>predictEthnicity</code> returns probabilities corresponding to each ethnicity for each sample (e.g <code>Prob_Caucasian</code>, <code>Prob_African</code>, <code>Prob_Asian</code>). This applies a glmnet model described in <a href="https://epigeneticsandchromatin.biomedcentral.com/articles/10.1186/s13072-019-0296-3">(Yuan 2019)</a>. A final classification is determined in two ways:</p>
<ol style="list-style-type: decimal">
<li><p><code>Predicted_ethnicity_nothresh</code> - returns a classification corresponding to the highest class-specific probability.</p></li>
<li><p><code>Predicted_ethnicity</code> - if the highest class-specific probability is below <code>0.75</code>, then the the sample is assigned an <code>Amibiguous</code> label. This threshold can be adjusted with the <code>threshold</code> argument. Samples with this label might require special attention in downstream analyses.</p></li>
</ol>
<div class="sourceCode" id="cb51"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">results</span> <span class="op">%&gt;%</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>
        x <span class="op">=</span> <span class="va">Prob_Caucasian</span>, y <span class="op">=</span> <span class="va">Prob_African</span>,
        col <span class="op">=</span> <span class="va">Predicted_ethnicity</span>
    <span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.7</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_cartesian.html">coord_cartesian</a></span><span class="op">(</span>xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_x_continuous</a></span><span class="op">(</span>labels <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="va"><a href="https://scales.r-lib.org/reference/label_percent.html">percent</a></span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span><span class="op">(</span>labels <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="va"><a href="https://scales.r-lib.org/reference/label_percent.html">percent</a></span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"P(Caucasian)"</span>, y <span class="op">=</span> <span class="st">"P(African)"</span><span class="op">)</span></code></pre></div>
<p><img src="planet_files/figure-html/unnamed-chunk-10-1.png"></p>
<div class="sourceCode" id="cb52"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">results</span> <span class="op">%&gt;%</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>
        x <span class="op">=</span> <span class="va">Prob_Caucasian</span>, y <span class="op">=</span> <span class="va">Prob_Asian</span>,
        col <span class="op">=</span> <span class="va">Predicted_ethnicity</span>
    <span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.7</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_cartesian.html">coord_cartesian</a></span><span class="op">(</span>xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_x_continuous</a></span><span class="op">(</span>labels <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="va"><a href="https://scales.r-lib.org/reference/label_percent.html">percent</a></span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span><span class="op">(</span>labels <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="va"><a href="https://scales.r-lib.org/reference/label_percent.html">percent</a></span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"P(Caucasian)"</span>, y <span class="op">=</span> <span class="st">"P(Asian)"</span><span class="op">)</span></code></pre></div>
<p><img src="planet_files/figure-html/unnamed-chunk-10-2.png"></p>
<p>We canâ€™t compare this to self-reported ethnicity as it is unavailable. But we know these samples were collected in Sydney, Australia, and are therefore likely mostly European with some East Asian participants.</p>
<div class="sourceCode" id="cb53"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">results</span><span class="op">$</span><span class="va">Predicted_ethnicity</span><span class="op">)</span></code></pre></div>
<pre><code>## 
##     Asian Caucasian 
##         2        22</code></pre>
<p><strong>A note on adjustment in differential methylation analysis</strong></p>
<p>Because â€˜Ambiguousâ€™ samples might have different mixtures of ancestries, it might be inadequate to adjust for them as one group in an analysis of admixed populations (e.g.Â 50/50 Asian/African should not be considered the same group as 50/50 Caucasian/African). One solution would be to simply remove these samples. Another would be to adjust for the raw probabilities-in this case, use only two of the three probabilities, since the third will be redundant (probabilities sum to 1). If sample numbers are large enough in each group, stratifying downstream analyses by ethnicity might also be a valid option.</p>
</div>
<div id="references" class="section level2">
<h2 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h2>
<p><a href="https://bmcgenomics.biomedcentral.com/articles/10.1186/s12864-020-07186-6">Yuan V, Hui D, Yin Y, PeÃ±aherrera MS, Beristain AG, Robinson WP. Cell-specific characterization of the placental methylome. BMC Genomics. 2021 Jan 6;22(1):6.</a></p>
<p><a href="https://epigeneticsandchromatin.biomedcentral.com/articles/10.1186/s13072-019-0296-3">Yuan V, Price EM, Del Gobbo G, Mostafavi S, Cox B, Binder AM, et al.Â Accurate ethnicity prediction from placental DNA methylation data. Epigenetics &amp; Chromatin. 2019 Aug 9;12(1):51.</a></p>
<p><a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC6628997/">Lee Y, Choufani S, Weksberg R, Wilson SL, Yuan V, Burt A, et al.Â Placental epigenetic clocks: estimating gestational age using placental DNA methylation levels. Aging (Albany NY). 2019 Jun 24;11(12):4238â€“53.</a></p>
</div>
<div id="session-info" class="section level2">
<h2 class="hasAnchor">
<a href="#session-info" class="anchor"></a>Session Info</h2>
<div class="sourceCode" id="cb55"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html">sessionInfo</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<pre><code>## R version 4.1.0 (2021-05-18)
## Platform: x86_64-w64-mingw32/x64 (64-bit)
## Running under: Windows 10 x64 (build 19042)
## 
## Matrix products: default
## 
## locale:
## [1] LC_COLLATE=English_Canada.1252  LC_CTYPE=English_Canada.1252   
## [3] LC_MONETARY=English_Canada.1252 LC_NUMERIC=C                   
## [5] LC_TIME=English_Canada.1252    
## 
## attached base packages:
## [1] stats4    parallel  stats     graphics  grDevices utils     datasets 
## [8] methods   base     
## 
## other attached packages:
##  [1] planet_1.0.0                tidyr_1.1.3                
##  [3] ggplot2_3.3.3               dplyr_1.0.6                
##  [5] EpiDISH_2.8.0               minfi_1.38.0               
##  [7] bumphunter_1.34.0           locfit_1.5-9.4             
##  [9] iterators_1.0.13            foreach_1.5.1              
## [11] Biostrings_2.60.1           XVector_0.32.0             
## [13] SummarizedExperiment_1.22.0 Biobase_2.52.0             
## [15] MatrixGenerics_1.4.0        matrixStats_0.59.0         
## [17] GenomicRanges_1.44.0        GenomeInfoDb_1.28.0        
## [19] IRanges_2.26.0              S4Vectors_0.30.0           
## [21] BiocGenerics_0.38.0        
## 
## loaded via a namespace (and not attached):
##   [1] BiocFileCache_2.0.0       plyr_1.8.6               
##   [3] splines_4.1.0             BiocParallel_1.26.0      
##   [5] digest_0.6.27             htmltools_0.5.1.1        
##   [7] fansi_0.5.0               magrittr_2.0.1           
##   [9] memoise_2.0.0             limma_3.48.0             
##  [11] readr_1.4.0               annotate_1.70.0          
##  [13] askpass_1.1               siggenes_1.66.0          
##  [15] prettyunits_1.1.1         colorspace_2.0-1         
##  [17] blob_1.2.1                rappdirs_0.3.3           
##  [19] xfun_0.23                 crayon_1.4.1             
##  [21] RCurl_1.98-1.3            jsonlite_1.7.2           
##  [23] genefilter_1.74.0         GEOquery_2.60.0          
##  [25] survival_3.2-11           glue_1.4.2               
##  [27] gtable_0.3.0              zlibbioc_1.38.0          
##  [29] DelayedArray_0.18.0       Rhdf5lib_1.14.1          
##  [31] HDF5Array_1.20.0          scales_1.1.1             
##  [33] DBI_1.1.1                 rngtools_1.5             
##  [35] Rcpp_1.0.6                xtable_1.8-4             
##  [37] progress_1.2.2            bit_4.0.4                
##  [39] proxy_0.4-26              mclust_5.4.7             
##  [41] preprocessCore_1.54.0     httr_1.4.2               
##  [43] RColorBrewer_1.1-2        ellipsis_0.3.2           
##  [45] farver_2.1.0              pkgconfig_2.0.3          
##  [47] reshape_0.8.8             XML_3.99-0.6             
##  [49] sass_0.4.0                dbplyr_2.1.1             
##  [51] utf8_1.2.1                labeling_0.4.2           
##  [53] tidyselect_1.1.1          rlang_0.4.11             
##  [55] AnnotationDbi_1.54.1      munsell_0.5.0            
##  [57] tools_4.1.0               cachem_1.0.5             
##  [59] generics_0.1.0            RSQLite_2.2.7            
##  [61] evaluate_0.14             stringr_1.4.0            
##  [63] fastmap_1.1.0             yaml_2.2.1               
##  [65] knitr_1.33                bit64_4.0.5              
##  [67] beanplot_1.2              scrime_1.3.5             
##  [69] purrr_0.3.4               KEGGREST_1.32.0          
##  [71] nlme_3.1-152              doRNG_1.8.2              
##  [73] sparseMatrixStats_1.4.0   nor1mix_1.3-0            
##  [75] xml2_1.3.2                biomaRt_2.48.0           
##  [77] compiler_4.1.0            filelock_1.0.2           
##  [79] curl_4.3.1                png_0.1-7                
##  [81] e1071_1.7-7               tibble_3.1.2             
##  [83] bslib_0.2.5.1             stringi_1.6.2            
##  [85] highr_0.9                 GenomicFeatures_1.44.0   
##  [87] lattice_0.20-44           Matrix_1.3-4             
##  [89] multtest_2.48.0           vctrs_0.3.8              
##  [91] pillar_1.6.1              lifecycle_1.0.0          
##  [93] rhdf5filters_1.4.0        jquerylib_0.1.4          
##  [95] data.table_1.14.0         bitops_1.0-7             
##  [97] rtracklayer_1.52.0        R6_2.5.0                 
##  [99] BiocIO_1.2.0              codetools_0.2-18         
## [101] MASS_7.3-54               assertthat_0.2.1         
## [103] rhdf5_2.36.0              openssl_1.4.4            
## [105] rjson_0.2.20              withr_2.4.2              
## [107] GenomicAlignments_1.28.0  Rsamtools_2.8.0          
## [109] GenomeInfoDbData_1.2.6    locfdr_1.1-8             
## [111] mgcv_1.8-35               hms_1.1.0                
## [113] quadprog_1.5-8            grid_4.1.0               
## [115] base64_2.0                class_7.3-19             
## [117] rmarkdown_2.8             DelayedMatrixStats_1.14.0
## [119] illuminaio_0.34.0         restfulr_0.0.13</code></pre>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Victor Yuan.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
